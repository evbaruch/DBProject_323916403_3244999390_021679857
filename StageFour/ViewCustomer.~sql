CREATE VIEW vw_CustomerAccountDetails AS
SELECT
    c.CustomerID,
    c.FirstName,
    c.LastName,
    a.AccountID,
    a.Balance,
    a.AccountStatus,
    b.BranchName,
    b.BranchAddress
FROM
    Customer c
JOIN
    Rel5 r ON c.CustomerID = r.CustomerID
JOIN
    Account a ON r.AccountID = a.AccountID
JOIN
    Branch b ON a.BranchID = b.BranchID;
/

SELECT BranchName, COUNT(CustomerID) AS NumberOfCustomers
FROM vw_CustomerAccountDetails
GROUP BY BranchName;
